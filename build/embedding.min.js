!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.EMBED=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){if(j===setTimeout)return setTimeout(a,0);try{return j(a,0)}catch(b){try{return j.call(null,a,0)}catch(b){return j.call(this,a,0)}}}function e(a){if(k===clearTimeout)return clearTimeout(a);try{return k(a)}catch(b){try{return k.call(null,a)}catch(b){return k.call(this,a)}}}function f(){o&&m&&(o=!1,m.length?n=m.concat(n):p=-1,n.length&&g())}function g(){if(!o){var a=d(f);o=!0;for(var b=n.length;b;){for(m=n,n=[];++p<b;)m&&m[p].run();p=-1,b=n.length}m=null,o=!1,e(a)}}function h(a,b){this.fun=a,this.array=b}function i(){}var j,k,l=b.exports={};!function(){try{j=setTimeout}catch(a){j=function(){throw new Error("setTimeout is not defined")}}try{k=clearTimeout}catch(a){k=function(){throw new Error("clearTimeout is not defined")}}}();var m,n=[],o=!1,p=-1;l.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];n.push(new h(a,b)),1!==n.length||o||d(g)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=i,l.addListener=i,l.once=i,l.off=i,l.removeListener=i,l.removeAllListeners=i,l.emit=i,l.binding=function(a){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(a){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],2:[function(a,b,c){"use strict";function d(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function e(){}var f=Object.prototype.hasOwnProperty,g="function"!=typeof Object.create?"~":!1;e.prototype._events=void 0,e.prototype.eventNames=function(){var a,b=this._events,c=[];if(!b)return c;for(a in b)f.call(b,a)&&c.push(g?a.slice(1):a);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(b)):c},e.prototype.listeners=function(a,b){var c=g?g+a:a,d=this._events&&this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var e=0,f=d.length,h=new Array(f);f>e;e++)h[e]=d[e].fn;return h},e.prototype.emit=function(a,b,c,d,e,f){var h=g?g+a:a;if(!this._events||!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if("function"==typeof k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,e),!0;case 6:return k.fn.call(k.context,b,c,d,e,f),!0}for(j=1,i=new Array(l-1);l>j;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;n>j;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;default:if(!i)for(m=1,i=new Array(l-1);l>m;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},e.prototype.on=function(a,b,c){var e=new d(b,c||this),f=g?g+a:a;return this._events||(this._events=g?{}:Object.create(null)),this._events[f]?this._events[f].fn?this._events[f]=[this._events[f],e]:this._events[f].push(e):this._events[f]=e,this},e.prototype.once=function(a,b,c){var e=new d(b,c||this,!0),f=g?g+a:a;return this._events||(this._events=g?{}:Object.create(null)),this._events[f]?this._events[f].fn?this._events[f]=[this._events[f],e]:this._events[f].push(e):this._events[f]=e,this},e.prototype.removeListener=function(a,b,c,d){var e=g?g+a:a;if(!this._events||!this._events[e])return this;var f=this._events[e],h=[];if(b)if(f.fn)(f.fn!==b||d&&!f.once||c&&f.context!==c)&&h.push(f);else for(var i=0,j=f.length;j>i;i++)(f[i].fn!==b||d&&!f[i].once||c&&f[i].context!==c)&&h.push(f[i]);return h.length?this._events[e]=1===h.length?h[0]:h:delete this._events[e],this},e.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[g?g+a:a]:this._events=g?{}:Object.create(null),this):this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prototype.setMaxListeners=function(){return this},e.prefixed=g,"undefined"!=typeof b&&(b.exports=e)},{}],3:[function(a,b,c){"use strict";function d(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function e(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de","5"===Object.getOwnPropertyNames(a)[0])return!1;for(var b={},c=0;10>c;c++)b["_"+String.fromCharCode(c)]=c;var d=Object.getOwnPropertyNames(b).map(function(a){return b[a]});if("0123456789"!==d.join(""))return!1;var e={};return"abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},e)).join("")?!1:!0}catch(f){return!1}}var f=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;b.exports=e()?Object.assign:function(a,b){for(var c,e,h=d(a),i=1;i<arguments.length;i++){c=Object(arguments[i]);for(var j in c)f.call(c,j)&&(h[j]=c[j]);if(Object.getOwnPropertySymbols){e=Object.getOwnPropertySymbols(c);for(var k=0;k<e.length;k++)g.call(c,e[k])&&(h[e[k]]=c[e[k]])}}return h}},{}],4:[function(b,c,d){!function(b){"use strict";function d(a,c){if(c=c||{},c.worker&&A.WORKERS_SUPPORTED){var d=m();return d.userStep=c.step,d.userChunk=c.chunk,d.userComplete=c.complete,d.userError=c.error,c.step=t(c.step),c.chunk=t(c.chunk),c.complete=t(c.complete),c.error=t(c.error),delete c.worker,void d.postMessage({input:a,config:c,workerId:d.id})}var e=null;return"string"==typeof a?e=c.download?new g(c):new i(c):(b.File&&a instanceof File||a instanceof Object)&&(e=new h(c)),e.stream(a)}function e(a,b){function c(){"object"==typeof b&&("string"==typeof b.delimiter&&1==b.delimiter.length&&-1==A.BAD_DELIMITERS.indexOf(b.delimiter)&&(i=b.delimiter),("boolean"==typeof b.quotes||b.quotes instanceof Array)&&(h=b.quotes),"string"==typeof b.newline&&(j=b.newline))}function d(a){if("object"!=typeof a)return[];var b=[];for(var c in a)b.push(c);return b}function e(a,b){var c="";"string"==typeof a&&(a=JSON.parse(a)),"string"==typeof b&&(b=JSON.parse(b));var d=a instanceof Array&&a.length>0,e=!(b[0]instanceof Array);if(d){for(var g=0;g<a.length;g++)g>0&&(c+=i),c+=f(a[g],g);b.length>0&&(c+=j)}for(var h=0;h<b.length;h++){for(var k=d?a.length:b[h].length,l=0;k>l;l++){l>0&&(c+=i);var m=d&&e?a[l]:l;c+=f(b[h][m],l)}h<b.length-1&&(c+=j)}return c}function f(a,b){if("undefined"==typeof a||null===a)return"";a=a.toString().replace(/"/g,'""');var c="boolean"==typeof h&&h||h instanceof Array&&h[b]||g(a,A.BAD_DELIMITERS)||a.indexOf(i)>-1||" "==a.charAt(0)||" "==a.charAt(a.length-1);return c?'"'+a+'"':a}function g(a,b){for(var c=0;c<b.length;c++)if(a.indexOf(b[c])>-1)return!0;return!1}var h=!1,i=",",j="\r\n";if(c(),"string"==typeof a&&(a=JSON.parse(a)),a instanceof Array){if(!a.length||a[0]instanceof Array)return e(null,a);if("object"==typeof a[0])return e(d(a[0]),a)}else if("object"==typeof a)return"string"==typeof a.data&&(a.data=JSON.parse(a.data)),a.data instanceof Array&&(a.fields||(a.fields=a.data[0]instanceof Array?a.fields:d(a.data[0])),a.data[0]instanceof Array||"object"==typeof a.data[0]||(a.data=[a.data])),e(a.fields||[],a.data||[]);throw"exception: Unable to serialize unrecognized input"}function f(a){function c(a){var b=r(a);b.chunkSize=parseInt(b.chunkSize),a.step||a.chunk||(b.chunkSize=null),this._handle=new j(b),this._handle.streamer=this,this._config=b}this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},c.call(this,a),this.parseChunk=function(a){if(this.isFirstChunk&&t(this._config.beforeFirstChunk)){var c=this._config.beforeFirstChunk(a);void 0!==c&&(a=c)}this.isFirstChunk=!1;var d=this._partialLine+a;this._partialLine="";var e=this._handle.parse(d,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var f=e.meta.cursor;this._finished||(this._partialLine=d.substring(f-this._baseIndex),this._baseIndex=f),e&&e.data&&(this._rowCount+=e.data.length);var g=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(w)b.postMessage({results:e,workerId:A.WORKER_ID,finished:g});else if(t(this._config.chunk)){if(this._config.chunk(e,this._handle),this._paused)return;e=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(e.data),this._completeResults.errors=this._completeResults.errors.concat(e.errors),this._completeResults.meta=e.meta),!g||!t(this._config.complete)||e&&e.meta.aborted||this._config.complete(this._completeResults),g||e&&e.meta.paused||this._nextChunk(),e}},this._sendError=function(a){t(this._config.error)?this._config.error(a):w&&this._config.error&&b.postMessage({workerId:A.WORKER_ID,error:a,finished:!1})}}function g(a){function b(a){var b=a.getResponseHeader("Content-Range");return parseInt(b.substr(b.lastIndexOf("/")+1))}a=a||{},a.chunkSize||(a.chunkSize=A.RemoteChunkSize),f.call(this,a);var c;v?this._nextChunk=function(){this._readChunk(),this._chunkLoaded()}:this._nextChunk=function(){this._readChunk()},this.stream=function(a){this._input=a,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded();if(c=new XMLHttpRequest,v||(c.onload=s(this._chunkLoaded,this),c.onerror=s(this._chunkError,this)),c.open("GET",this._input,!v),this._config.chunkSize){var a=this._start+this._config.chunkSize-1;c.setRequestHeader("Range","bytes="+this._start+"-"+a),c.setRequestHeader("If-None-Match","webkit-no-cache")}try{c.send()}catch(b){this._chunkError(b.message)}v&&0==c.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4==c.readyState){if(c.status<200||c.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>b(c),this.parseChunk(c.responseText)}},this._chunkError=function(a){var b=c.statusText||a;this._sendError(b)}}function h(a){a=a||{},a.chunkSize||(a.chunkSize=A.LocalChunkSize),f.call(this,a);var b,c,d="undefined"!=typeof FileReader;this.stream=function(a){this._input=a,c=a.slice||a.webkitSlice||a.mozSlice,d?(b=new FileReader,b.onload=s(this._chunkLoaded,this),b.onerror=s(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var a=this._input;if(this._config.chunkSize){var e=Math.min(this._start+this._config.chunkSize,this._input.size);a=c.call(a,this._start,e)}var f=b.readAsText(a,this._config.encoding);d||this._chunkLoaded({target:{result:f}})},this._chunkLoaded=function(a){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(a.target.result)},this._chunkError=function(){this._sendError(b.error)}}function i(a){a=a||{},f.call(this,a);var b,c;this.stream=function(a){return b=a,c=a,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var a=this._config.chunkSize,b=a?c.substr(0,a):c;return c=a?c.substr(a):"",this._finished=!c,this.parseChunk(b)}}}function j(a){function b(){if(v&&m&&(i("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+A.DefaultDelimiter+"'"),m=!1),a.skipEmptyLines)for(var b=0;b<v.data.length;b++)1==v.data[b].length&&""==v.data[b][0]&&v.data.splice(b--,1);return c()&&d(),e()}function c(){return a.header&&0==u.length}function d(){if(v){for(var a=0;c()&&a<v.data.length;a++)for(var b=0;b<v.data[a].length;b++)u.push(v.data[a][b]);v.data.splice(0,1)}}function e(){if(!v||!a.header&&!a.dynamicTyping)return v;for(var b=0;b<v.data.length;b++){for(var c={},d=0;d<v.data[b].length;d++){if(a.dynamicTyping){var e=v.data[b][d];"true"==e||"TRUE"==e?v.data[b][d]=!0:"false"==e||"FALSE"==e?v.data[b][d]=!1:v.data[b][d]=h(e)}a.header&&(d>=u.length?(c.__parsed_extra||(c.__parsed_extra=[]),c.__parsed_extra.push(v.data[b][d])):c[u[d]]=v.data[b][d])}a.header&&(v.data[b]=c,d>u.length?i("FieldMismatch","TooManyFields","Too many fields: expected "+u.length+" fields but parsed "+d,b):d<u.length&&i("FieldMismatch","TooFewFields","Too few fields: expected "+u.length+" fields but parsed "+d,b))}return a.header&&v.meta&&(v.meta.fields=u),v}function f(b){for(var c,d,e,f=[",","	","|",";",A.RECORD_SEP,A.UNIT_SEP],g=0;g<f.length;g++){var h=f[g],i=0,j=0;e=void 0;for(var l=new k({delimiter:h,preview:10}).parse(b),m=0;m<l.data.length;m++){var n=l.data[m].length;j+=n,"undefined"!=typeof e?n>1&&(i+=Math.abs(n-e),e=n):e=n}l.data.length>0&&(j/=l.data.length),("undefined"==typeof d||d>i)&&j>1.99&&(d=i,c=h)}return a.delimiter=c,{successful:!!c,bestDelimiter:c}}function g(a){a=a.substr(0,1048576);var b=a.split("\r");if(1==b.length)return"\n";for(var c=0,d=0;d<b.length;d++)"\n"==b[d][0]&&c++;return c>=b.length/2?"\r\n":"\r"}function h(a){var b=n.test(a);return b?parseFloat(a):a}function i(a,b,c,d){v.errors.push({type:a,code:b,message:c,row:d})}var j,l,m,n=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,o=this,p=0,q=!1,s=!1,u=[],v={data:[],errors:[],meta:{}};if(t(a.step)){var w=a.step;a.step=function(d){if(v=d,c())b();else{if(b(),0==v.data.length)return;p+=d.data.length,a.preview&&p>a.preview?l.abort():w(v,o)}}}this.parse=function(c,d,e){if(a.newline||(a.newline=g(c)),m=!1,!a.delimiter){var h=f(c);h.successful?a.delimiter=h.bestDelimiter:(m=!0,a.delimiter=A.DefaultDelimiter),v.meta.delimiter=a.delimiter}var i=r(a);return a.preview&&a.header&&i.preview++,j=c,l=new k(i),v=l.parse(j,d,e),b(),q?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,l.abort(),j=j.substr(l.getCharIndex())},this.resume=function(){q=!1,o.streamer.parseChunk(j)},this.aborted=function(){return s},this.abort=function(){s=!0,l.abort(),v.meta.aborted=!0,t(a.complete)&&a.complete(v),j=""}}function k(a){a=a||{};var b=a.delimiter,c=a.newline,d=a.comments,e=a.step,f=a.preview,g=a.fastMode;if(("string"!=typeof b||A.BAD_DELIMITERS.indexOf(b)>-1)&&(b=","),d===b)throw"Comment character same as delimiter";d===!0?d="#":("string"!=typeof d||A.BAD_DELIMITERS.indexOf(d)>-1)&&(d=!1),"\n"!=c&&"\r"!=c&&"\r\n"!=c&&(c="\n");var h=0,i=!1;this.parse=function(a,j,k){function l(a){v.push(a),y=h}function m(b){return k?o():("undefined"==typeof b&&(b=a.substr(h)),x.push(b),h=q,l(x),u&&p(),o())}function n(b){h=b,l(x),x=[],C=a.indexOf(c,h)}function o(a){return{data:v,errors:w,meta:{delimiter:b,linebreak:c,aborted:i,truncated:!!a,cursor:y+(j||0)}}}function p(){e(o()),v=[],w=[]}if("string"!=typeof a)throw"Input must be a string";var q=a.length,r=b.length,s=c.length,t=d.length,u="function"==typeof e;h=0;var v=[],w=[],x=[],y=0;if(!a)return o();if(g||g!==!1&&-1===a.indexOf('"')){for(var z=a.split(c),A=0;A<z.length;A++){var x=z[A];if(h+=x.length,A!==z.length-1)h+=c.length;else if(k)return o();if(!d||x.substr(0,t)!=d){if(u){if(v=[],l(x.split(b)),p(),i)return o()}else l(x.split(b));if(f&&A>=f)return v=v.slice(0,f),o(!0)}}return o()}for(var B=a.indexOf(b,h),C=a.indexOf(c,h);;)if('"'!=a[h])if(d&&0===x.length&&a.substr(h,t)===d){if(-1==C)return o();h=C+s,C=a.indexOf(c,h),B=a.indexOf(b,h)}else if(-1!==B&&(C>B||-1===C))x.push(a.substring(h,B)),h=B+r,B=a.indexOf(b,h);else{if(-1===C)break;if(x.push(a.substring(h,C)),n(C+s),u&&(p(),i))return o();if(f&&v.length>=f)return o(!0)}else{var D=h;for(h++;;){var D=a.indexOf('"',D+1);if(-1===D)return k||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:h}),m();if(D===q-1){var E=a.substring(h,D).replace(/""/g,'"');return m(E)}if('"'!=a[D+1]){if(a[D+1]==b){x.push(a.substring(h,D).replace(/""/g,'"')),h=D+1+r,B=a.indexOf(b,h),C=a.indexOf(c,h);break}if(a.substr(D+1,s)===c){if(x.push(a.substring(h,D).replace(/""/g,'"')),n(D+1+s),B=a.indexOf(b,h),u&&(p(),i))return o();if(f&&v.length>=f)return o(!0);break}}else D++}}return m()},this.abort=function(){i=!0},this.getCharIndex=function(){return h}}function l(){var a=document.getElementsByTagName("script");return a.length?a[a.length-1].src:""}function m(){if(!A.WORKERS_SUPPORTED)return!1;if(!x&&null===A.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var a=A.SCRIPT_PATH||u;a+=(-1!==a.indexOf("?")?"&":"?")+"papaworker";var c=new b.Worker(a);return c.onmessage=n,c.id=z++,y[c.id]=c,c}function n(a){var b=a.data,c=y[b.workerId],d=!1;if(b.error)c.userError(b.error,b.file);else if(b.results&&b.results.data){var e=function(){d=!0,o(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},f={abort:e,pause:p,resume:p};if(t(c.userStep)){for(var g=0;g<b.results.data.length&&(c.userStep({data:[b.results.data[g]],errors:b.results.errors,meta:b.results.meta},f),!d);g++);delete b.results}else t(c.userChunk)&&(c.userChunk(b.results,f,b.file),delete b.results)}b.finished&&!d&&o(b.workerId,b.results)}function o(a,b){var c=y[a];t(c.userComplete)&&c.userComplete(b),c.terminate(),delete y[a]}function p(){throw"Not implemented."}function q(a){var c=a.data;if("undefined"==typeof A.WORKER_ID&&c&&(A.WORKER_ID=c.workerId),"string"==typeof c.input)b.postMessage({workerId:A.WORKER_ID,results:A.parse(c.input,c.config),finished:!0});else if(b.File&&c.input instanceof File||c.input instanceof Object){var d=A.parse(c.input,c.config);d&&b.postMessage({workerId:A.WORKER_ID,results:d,finished:!0})}}function r(a){if("object"!=typeof a)return a;var b=a instanceof Array?[]:{};for(var c in a)b[c]=r(a[c]);return b}function s(a,b){return function(){a.apply(b,arguments)}}function t(a){return"function"==typeof a}var u,v=!b.document&&!!b.postMessage,w=v&&/(\?|&)papaworker(=|&|$)/.test(b.location.search),x=!1,y={},z=0,A={};if(A.parse=d,A.unparse=e,A.RECORD_SEP=String.fromCharCode(30),A.UNIT_SEP=String.fromCharCode(31),A.BYTE_ORDER_MARK="\ufeff",A.BAD_DELIMITERS=["\r","\n",'"',A.BYTE_ORDER_MARK],A.WORKERS_SUPPORTED=!v&&!!b.Worker,A.SCRIPT_PATH=null,A.LocalChunkSize=10485760,A.RemoteChunkSize=5242880,A.DefaultDelimiter=",",A.Parser=k,A.ParserHandle=j,A.NetworkStreamer=g,A.FileStreamer=h,A.StringStreamer=i,"undefined"!=typeof c&&c.exports?c.exports=A:t(b.define)&&b.define.amd?a(function(){return A}):b.Papa=A,b.jQuery){var B=b.jQuery;B.fn.parse=function(a){function c(){if(0==g.length)return void(t(a.complete)&&a.complete());var b=g[0];if(t(a.before)){var c=a.before(b.file,b.inputElem);if("object"==typeof c){if("abort"==c.action)return void d("AbortError",b.file,b.inputElem,c.reason);if("skip"==c.action)return void e();"object"==typeof c.config&&(b.instanceConfig=B.extend(b.instanceConfig,c.config))}else if("skip"==c)return void e()}var f=b.instanceConfig.complete;b.instanceConfig.complete=function(a){t(f)&&f(a,b.file,b.inputElem),e()},A.parse(b.file,b.instanceConfig)}function d(b,c,d,e){t(a.error)&&a.error({name:b},c,d,e)}function e(){g.splice(0,1),c()}var f=a.config||{},g=[];return this.each(function(a){var c="INPUT"==B(this).prop("tagName").toUpperCase()&&"file"==B(this).attr("type").toLowerCase()&&b.FileReader;if(!c||!this.files||0==this.files.length)return!0;for(var d=0;d<this.files.length;d++)g.push({file:this.files[d],inputElem:this,instanceConfig:B.extend({},f)})}),c(),this}}w?b.onmessage=q:A.WORKERS_SUPPORTED&&(u=l(),document.body?document.addEventListener("DOMContentLoaded",function(){x=!0},!0):x=!0),g.prototype=Object.create(f.prototype),g.prototype.constructor=g,h.prototype=Object.create(f.prototype),h.prototype.constructor=h,i.prototype=Object.create(i.prototype),i.prototype.constructor=i}("undefined"!=typeof window?window:this)},{}],5:[function(a,b,c){"use strict";function d(a,b){return b.encode?b.strict?e(a):encodeURIComponent(a):a}var e=a("strict-uri-encode"),f=a("object-assign");c.extract=function(a){return a.split("?")[1]||""},c.parse=function(a){var b=Object.create(null);return"string"!=typeof a?b:(a=a.trim().replace(/^(\?|#|&)/,""))?(a.split("&").forEach(function(a){var c=a.replace(/\+/g," ").split("="),d=c.shift(),e=c.length>0?c.join("="):void 0;d=decodeURIComponent(d),e=void 0===e?null:decodeURIComponent(e),void 0===b[d]?b[d]=e:Array.isArray(b[d])?b[d].push(e):b[d]=[b[d],e]}),b):b},c.stringify=function(a,b){var c={encode:!0,strict:!0};return b=f(c,b),a?Object.keys(a).sort().map(function(c){var e=a[c];if(void 0===e)return"";if(null===e)return d(c,b);if(Array.isArray(e)){var f=[];return e.slice().forEach(function(a){void 0!==a&&(null===a?f.push(d(c,b)):f.push(d(c,b)+"="+d(a,b)))}),f.join("&")}return d(c,b)+"="+d(e,b)}).filter(function(a){return a.length>0}).join("&"):""}},{"object-assign":3,"strict-uri-encode":6}],6:[function(a,b,c){"use strict";b.exports=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}},{}],7:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=new THREE.Vector3(.155,-.465,-.15),g=new THREE.Vector3(0,0,-.25),h=new THREE.Vector3(0,0,.05),i=new THREE.Vector3(-.08,.14,.08),j=.4,k=.4,l=.61,m=function(){function a(){d(this,a),this.isLeftHanded=!1,this.controllerQ=new THREE.Quaternion,this.lastControllerQ=new THREE.Quaternion,this.headQ=new THREE.Quaternion,this.headPos=new THREE.Vector3,this.elbowPos=new THREE.Vector3,this.wristPos=new THREE.Vector3,this.time=null,this.lastTime=null,this.rootQ=new THREE.Quaternion,this.pose={orientation:new THREE.Quaternion,position:new THREE.Vector3}}return e(a,[{key:"setControllerOrientation",value:function(a){this.lastControllerQ.copy(this.controllerQ),this.controllerQ.copy(a)}},{key:"setHeadOrientation",value:function(a){this.headQ.copy(a)}},{key:"setHeadPosition",value:function(a){this.headPos.copy(a)}},{key:"setLeftHanded",value:function(a){this.isLeftHanded=a}},{key:"update",value:function(){this.time=performance.now();var a=this.getHeadYawOrientation_(),b=(this.time-this.lastTime)/1e3,c=this.quatAngle_(this.lastControllerQ,this.controllerQ),d=c/b;d>l?this.rootQ.slerp(a,c/10):this.rootQ.copy(a);var e=(new THREE.Euler).setFromQuaternion(this.controllerQ,"YXZ"),m=THREE.Math.radToDeg(e.x),n=this.clamp_((m-11)/39,0,1),o=this.rootQ.clone().inverse();o.multiply(this.controllerQ);var p=this.elbowPos;p.copy(this.headPos).add(f);var q=(new THREE.Vector3).copy(i);q.multiplyScalar(n),p.add(q);var r=this.quatAngle_(o,new THREE.Quaternion),s=THREE.Math.radToDeg(r),t=1-Math.pow(s/180,4),u=j,v=1-j,w=t*(u+v*n*k),x=(new THREE.Quaternion).slerp(o,w),y=x.inverse(),z=o.clone().multiply(y),A=this.wristPos;A.copy(h),A.applyQuaternion(x),A.add(g),A.applyQuaternion(z),A.add(this.elbowPos);var B=(new THREE.Vector3).copy(i);B.multiplyScalar(n);var C=(new THREE.Vector3).copy(this.wristPos);C.add(B),C.applyQuaternion(this.rootQ);var D=(new THREE.Quaternion).copy(this.controllerQ);this.pose.orientation.copy(D),this.pose.position.copy(C),this.lastTime=this.time}},{key:"getPose",value:function(){return this.pose}},{key:"getForearmLength",value:function(){return g.length()}},{key:"getElbowPosition",value:function(){var a=this.elbowPos.clone();return a.applyQuaternion(this.rootQ)}},{key:"getWristPosition",value:function(){var a=this.wristPos.clone();return a.applyQuaternion(this.rootQ)}},{key:"getHeadYawOrientation_",value:function(){var a=(new THREE.Euler).setFromQuaternion(this.headQ,"YXZ");a.x=0,a.z=0;var b=(new THREE.Quaternion).setFromEuler(a);return b}},{key:"clamp_",value:function(a,b,c){return Math.min(Math.max(a,b),c)}},{key:"quatAngle_",value:function(a,b){var c=new THREE.Vector3(0,0,-1),d=new THREE.Vector3(0,0,-1);return c.applyQuaternion(a),d.applyQuaternion(b),c.angleTo(d)}}]),a}();c["default"]=m},{}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("eventemitter3"),j=d(i),k=a("./ray-interaction-modes"),l=d(k),m=a("./util"),n=10,o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.renderer=a,c.availableInteractions={},window.addEventListener("mousedown",c.onMouseDown_.bind(c)),window.addEventListener("mousemove",c.onMouseMove_.bind(c)),window.addEventListener("mouseup",c.onMouseUp_.bind(c)),window.addEventListener("touchstart",c.onTouchStart_.bind(c)),window.addEventListener("touchmove",c.onTouchMove_.bind(c)),window.addEventListener("touchend",c.onTouchEnd_.bind(c)),c.pointer=new THREE.Vector2,c.lastPointer=new THREE.Vector2,c.pointerNdc=new THREE.Vector2,c.dragDistance=0,c.isDragging=!1,c.isTouchActive=!1,c.gamepad=null,navigator.getVRDisplays?navigator.getVRDisplays().then(function(a){c.vrDisplay=a[0]}):console.warn("WebVR API not available! Consider using the webvr-polyfill."),c}return g(b,a),h(b,[{key:"getInteractionMode",value:function(){var a=this.getVRGamepad_();if(!a)return m.isMobile()?this.vrDisplay&&this.vrDisplay.isPresenting?l["default"].VR_0DOF:l["default"].TOUCH:l["default"].MOUSE;var b=a.pose;return b.hasPosition?l["default"].VR_6DOF:b.hasOrientation?l["default"].VR_3DOF:l["default"].TOUCH}},{key:"getGamepadPose",value:function(){var a=this.getVRGamepad_();return a.pose}},{key:"getIsTouchActive",value:function(){return this.isTouchActive}},{key:"setSize",value:function(a){this.size=a}},{key:"update",value:function(){var a=this.getInteractionMode();if(a==l["default"].VR_3DOF||a==l["default"].VR_6DOF){var b=this.getGamepadButtonPressed_();b&&!this.wasGamepadPressed&&this.emit("raydown"),!b&&this.wasGamepadPressed&&this.emit("rayup"),this.wasGamepadPressed=b}}},{key:"getGamepadButtonPressed_",value:function(){var a=this.getVRGamepad_();if(!a)return!1;for(var b=0;b<a.buttons.length;++b)if(a.buttons[b].pressed)return!0;return!1}},{key:"onMouseDown_",value:function(a){this.startDragging_(a),this.emit("raydown")}},{key:"onMouseMove_",value:function(a){this.updatePointer_(a),this.updateDragDistance_(),this.emit("pointermove",this.pointerNdc)}},{key:"onMouseUp_",value:function(a){this.endDragging_()}},{key:"onTouchStart_",value:function(a){this.isTouchActive=!0;var b=a.touches[0];this.startDragging_(b),this.updateTouchPointer_(a),this.emit("pointermove",this.pointerNdc),this.emit("raydown"),a.preventDefault()}},{key:"onTouchMove_",value:function(a){this.updateTouchPointer_(a),this.updateDragDistance_(),a.preventDefault()}},{key:"onTouchEnd_",value:function(a){this.endDragging_(),a.preventDefault(),this.isTouchActive=!1}},{key:"updateTouchPointer_",value:function(a){if(0===a.touches.length)return void console.warn("Received touch event with no touches.");var b=a.touches[0];this.updatePointer_(b)}},{key:"updatePointer_",value:function(a){this.pointer.set(a.clientX,a.clientY),this.pointerNdc.x=a.clientX/this.size.width*2-1,this.pointerNdc.y=2*-(a.clientY/this.size.height)+1}},{key:"updateDragDistance_",value:function(){if(this.isDragging){var a=this.lastPointer.sub(this.pointer).length();this.dragDistance+=a,this.lastPointer.copy(this.pointer),this.dragDistance>n&&(this.emit("raycancel"),this.isDragging=!1)}}},{key:"startDragging_",value:function(a){this.isDragging=!0,this.lastPointer.set(a.clientX,a.clientY)}},{key:"endDragging_",value:function(){this.dragDistance<n&&this.emit("rayup"),this.dragDistance=0,this.isDragging=!1}},{key:"getVRGamepad_",value:function(){if(!navigator.getGamepads)return null;for(var a=navigator.getGamepads(),b=0;b<a.length;++b){var c=a[b];if(c&&c.pose)return c}return null}}]),b}(j["default"]);c["default"]=o},{"./ray-interaction-modes":10,"./util":12,eventemitter3:2}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("./orientation-arm-model"),j=d(i),k=a("eventemitter3"),l=d(k),m=a("./ray-renderer"),n=d(m),o=a("./ray-controller"),p=d(o),q=a("./ray-interaction-modes"),r=d(q),s=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.camera=a,c.renderer=new n["default"](a),c.controller=new p["default"],c.armModel=new j["default"],c.controller.on("raydown",c.onRayDown_.bind(c)),c.controller.on("rayup",c.onRayUp_.bind(c)),c.controller.on("raycancel",c.onRayCancel_.bind(c)),c.controller.on("pointermove",c.onPointerMove_.bind(c)),c.renderer.on("rayover",function(a){c.emit("rayover",a)}),c.renderer.on("rayout",function(a){c.emit("rayout",a)}),c.pointerNdc=new THREE.Vector2(1,1),c.handlers={},c}return g(b,a),h(b,[{key:"add",value:function(a,b){this.renderer.add(a,b),this.handlers[a.id]=b}},{key:"remove",value:function(a){this.renderer.remove(a),delete this.handlers[a.id]}},{key:"update",value:function(){var a=new THREE.Vector3(0,0,-1);a.applyQuaternion(this.camera.quaternion);var b=this.controller.getInteractionMode();switch(b){case r["default"].MOUSE:this.renderer.setPointer(this.pointerNdc),this.renderer.setRayVisibility(!1),this.renderer.setReticleVisibility(!1),this.renderer.setActive(!0);break;case r["default"].TOUCH:this.renderer.setPointer(this.pointerNdc),this.renderer.setRayVisibility(!1),this.renderer.setReticleVisibility(!1),this.renderer.setActive(this.controller.getIsTouchActive());break;case r["default"].VR_0DOF:this.renderer.setPosition(this.camera.position),this.renderer.setOrientation(this.camera.quaternion),this.renderer.setRayVisibility(!1),this.renderer.setReticleVisibility(!0),this.renderer.setActive(!0);
break;case r["default"].VR_3DOF:var c=this.controller.getGamepadPose(),d=(new THREE.Quaternion).fromArray(c.orientation);this.armModel.setHeadOrientation(this.camera.quaternion),this.armModel.setHeadPosition(this.camera.position),this.armModel.setControllerOrientation(d),this.armModel.update();var e=this.armModel.getPose();this.renderer.setPosition(e.position),this.renderer.setOrientation(e.orientation),this.renderer.setRayVisibility(!0),this.renderer.setReticleVisibility(!0),this.renderer.setActive(!0);break;case r["default"].VR_6DOF:console.log("6DOF");var c=this.controller.getGamepadPose();if(!c.orientation||!c.position){console.warn("Invalid gamepad pose. Can't update ray.");break}var f=(new THREE.Quaternion).fromArray(c.orientation),g=(new THREE.Vector3).fromArray(c.position);this.renderer.setOrientation(f),this.renderer.setPosition(g),this.renderer.setRayVisibility(!0),this.renderer.setReticleVisibility(!0),this.renderer.setActive(!0);break;default:console.error("Unknown interaction mode.")}this.renderer.update(),this.controller.update()}},{key:"setSize",value:function(a){this.controller.setSize(a)}},{key:"getMesh",value:function(){return this.renderer.getReticleRayMesh()}},{key:"getOrigin",value:function(){return this.renderer.getOrigin()}},{key:"getDirection",value:function(){return this.renderer.getDirection()}},{key:"getRightDirection",value:function(){var a=new THREE.Vector3(0,0,-1);return a.applyQuaternion(this.camera.quaternion),(new THREE.Vector3).crossVectors(a,this.camera.up)}},{key:"onRayDown_",value:function(a){this.renderer.update();var b=this.renderer.getSelectedMesh();this.emit("raydown",b),this.renderer.setActive(!0)}},{key:"onRayUp_",value:function(a){var b=this.renderer.getSelectedMesh();this.emit("rayup",b),this.renderer.setActive(!1)}},{key:"onRayCancel_",value:function(a){var b=this.renderer.getSelectedMesh();this.emit("raycancel",b)}},{key:"onPointerMove_",value:function(a){this.pointerNdc.copy(a)}}]),b}(l["default"]);c["default"]=s},{"./orientation-arm-model":7,"./ray-controller":8,"./ray-interaction-modes":10,"./ray-renderer":11,eventemitter3:2}],10:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={MOUSE:1,TOUCH:2,VR_0DOF:3,VR_3DOF:4,VR_6DOF:5};c["default"]=d},{}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("./util"),j=a("eventemitter3"),k=d(j),l=3,m=.02,n=.04,o=.02,p=i.base64("image/png","iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAABdklEQVR4nO3WwXHEQAwDQcin/FOWw+BjuiPYB2q4G2nP933P9SO4824zgDADiDOAuHfb3/UjuKMAcQYQZwBx/gBxChCnAHEKEKcAcQoQpwBxChCnAHEGEGcAcf4AcQoQZwBxBhBnAHEGEGcAcQYQZwBxBhBnAHEGEGcAcQYQZwBxBhBnAHHvtt/1I7ijAHEGEGcAcf4AcQoQZwBxTkCcAsQZQJwTEKcAcQoQpwBxBhDnBMQpQJwCxClAnALEKUCcAsQpQJwCxClAnALEKUCcAsQpQJwBxDkBcQoQpwBxChCnAHEKEKcAcQoQpwBxChCnAHEKEGcAcU5AnALEKUCcAsQZQJwTEKcAcQYQ5wTEKUCcAcQZQJw/QJwCxBlAnAHEGUCcAcQZQJwBxBlAnAHEGUCcAcQZQJwBxBlAnAHEGUDcu+25fgR3FCDOAOIMIM4fIE4B4hQgTgHiFCBOAeIUIE4B4hQgzgDiDCDOHyBOAeIMIM4A4v4B/5IF9eD6QxgAAAAASUVORK5CYII="),q=function(a){function b(a,c){e(this,b);var d=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.camera=a;return d.meshes={},d.selected={},d.raycaster=new THREE.Raycaster,d.position=new THREE.Vector3,d.orientation=new THREE.Quaternion,d.root=new THREE.Object3D,d.reticle=d.createReticle_(),d.root.add(d.reticle),d.ray=d.createRay_(),d.root.add(d.ray),d.reticleDistance=l,d}return g(b,a),h(b,[{key:"add",value:function(a){this.meshes[a.id]=a}},{key:"remove",value:function(a){var b=a.id;this.meshes[b]||delete this.meshes[b],this.selected[b]&&delete this.selected[a.id]}},{key:"update",value:function(){for(var a in this.meshes){var b=this.meshes[a],c=this.raycaster.intersectObject(b,!0);c.length>1&&console.warn("Unexpected: multiple meshes intersected.");var d=c.length>0,e=this.selected[a];d&&!e&&(this.selected[a]=!0,this.isActive&&this.emit("rayover",b)),!d&&e&&(delete this.selected[a],this.moveReticle_(null),this.isActive&&this.emit("rayout",b)),d&&this.moveReticle_(c)}}},{key:"setPosition",value:function(a){this.position.copy(a),this.raycaster.ray.origin.copy(a),this.updateRaycaster_()}},{key:"getOrigin",value:function(){return this.raycaster.ray.origin}},{key:"setOrientation",value:function(a){this.orientation.copy(a);var b=new THREE.Vector3(0,0,-1).applyQuaternion(a);this.raycaster.ray.direction.copy(b),this.updateRaycaster_()}},{key:"getDirection",value:function(){return this.raycaster.ray.direction}},{key:"setPointer",value:function(a){this.raycaster.setFromCamera(a,this.camera),this.updateRaycaster_()}},{key:"getReticleRayMesh",value:function(){return this.root}},{key:"getSelectedMesh",value:function(){var a=0,b=null;for(var c in this.selected)a+=1,b=this.meshes[c];return a>1&&console.warn("More than one mesh selected."),b}},{key:"setReticleVisibility",value:function(a){this.reticle.visible=a}},{key:"setRayVisibility",value:function(a){this.ray.visible=a}},{key:"setActive",value:function(a){if(this.isActive!=a&&(this.isActive=a,!a)){this.moveReticle_(null);for(var b in this.selected){var c=this.meshes[b];delete this.selected[b],this.emit("rayout",c)}}}},{key:"updateRaycaster_",value:function(){var a=this.raycaster.ray,b=this.reticle.position;b.copy(a.direction),b.multiplyScalar(this.reticleDistance),b.add(a.origin);var c=(new THREE.Vector3).copy(a.direction);c.multiplyScalar(this.reticleDistance),this.ray.scale.y=c.length();var d=new THREE.ArrowHelper(a.direction,a.origin);this.ray.rotation.copy(d.rotation),this.ray.position.addVectors(a.origin,c.multiplyScalar(.5))}},{key:"createReticle_",value:function(){var a=new THREE.SphereGeometry(m,32,32),b=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.9}),c=new THREE.Mesh(a,b),d=new THREE.SphereGeometry(n,32,32),e=new THREE.MeshBasicMaterial({color:3355443,transparent:!0,opacity:.3}),f=new THREE.Mesh(d,e),g=new THREE.Group;return g.add(c),g.add(f),g}},{key:"moveReticle_",value:function(a){var b=l;if(a){var c=a[0];b=c.distance}this.reticleDistance=b,this.updateRaycaster_()}},{key:"createRay_",value:function(){var a=new THREE.CylinderGeometry(o,o,1,32),b=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(p),transparent:!0,opacity:.3}),c=new THREE.Mesh(a,b);return c}}]),b}(k["default"]);c["default"]=q},{"./util":12,eventemitter3:2}],12:[function(a,b,c){"use strict";function d(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function e(a,b){return"data:"+a+";base64,"+b}Object.defineProperty(c,"__esModule",{value:!0}),c.isMobile=d,c.base64=e},{}],13:[function(b,c,d){(function(b){var e=e||function(){var a=[];return{getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},update:function(b,c){if(0===a.length)return!1;var d=0;for(b=void 0!==b?b:e.now();d<a.length;)a[d].update(b)||c?d++:a.splice(d,1);return!0}}}();!function(){void 0===this.window&&void 0!==this.process?e.now=function(){var a=b.hrtime();return 1e3*a[0]+a[1]/1e3}:void 0!==this.window&&void 0!==window.performance&&void 0!==window.performance.now?e.now=window.performance.now.bind(window.performance):void 0!==Date.now?e.now=Date.now:e.now=function(){return(new Date).getTime()}}(),e.Tween=function(a){var b=a,c={},d={},f={},g=1e3,h=0,i=!1,j=!1,k=!1,l=0,m=null,n=e.Easing.Linear.None,o=e.Interpolation.Linear,p=[],q=null,r=!1,s=null,t=null,u=null;for(var v in a)c[v]=parseFloat(a[v],10);this.to=function(a,b){return void 0!==b&&(g=b),d=a,this},this.start=function(a){e.add(this),j=!0,r=!1,m=void 0!==a?a:e.now(),m+=l;for(var g in d){if(d[g]instanceof Array){if(0===d[g].length)continue;d[g]=[b[g]].concat(d[g])}void 0!==c[g]&&(c[g]=b[g],c[g]instanceof Array==!1&&(c[g]*=1),f[g]=c[g]||0)}return this},this.stop=function(){return j?(e.remove(this),j=!1,null!==u&&u.call(b),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var a=0,b=p.length;b>a;a++)p[a].stop()},this.delay=function(a){return l=a,this},this.repeat=function(a){return h=a,this},this.yoyo=function(a){return i=a,this},this.easing=function(a){return n=a,this},this.interpolation=function(a){return o=a,this},this.chain=function(){return p=arguments,this},this.onStart=function(a){return q=a,this},this.onUpdate=function(a){return s=a,this},this.onComplete=function(a){return t=a,this},this.onStop=function(a){return u=a,this},this.update=function(a){var e,j,u;if(m>a)return!0;r===!1&&(null!==q&&q.call(b),r=!0),j=(a-m)/g,j=j>1?1:j,u=n(j);for(e in d)if(void 0!==c[e]){var v=c[e]||0,w=d[e];w instanceof Array?b[e]=o(w,u):("string"==typeof w&&(w="+"===w.charAt(0)||"-"===w.charAt(0)?v+parseFloat(w,10):parseFloat(w,10)),"number"==typeof w&&(b[e]=v+(w-v)*u))}if(null!==s&&s.call(b,u),1===j){if(h>0){isFinite(h)&&h--;for(e in f){if("string"==typeof d[e]&&(f[e]=f[e]+parseFloat(d[e],10)),i){var x=f[e];f[e]=d[e],d[e]=x}c[e]=f[e]}return i&&(k=!k),m=a+l,!0}null!==t&&t.call(b);for(var y=0,z=p.length;z>y;y++)p[y].start(m+g);return!1}return!0}},e.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){return 0===a?0:1===a?1:(a*=2,1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1)}},Back:{In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},InOut:function(a){var b=2.5949095;return(a*=2)<1?.5*(a*a*((b+1)*a-b)):.5*((a-=2)*a*((b+1)*a+b)+2)}},Bounce:{In:function(a){return 1-e.Easing.Bounce.Out(1-a)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*e.Easing.Bounce.In(2*a):.5*e.Easing.Bounce.Out(2*a-1)+.5}}},e.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,f=Math.floor(d),g=e.Interpolation.Utils.Linear;return 0>b?g(a[0],a[1],d):b>1?g(a[c],a[c-1],c-d):g(a[f],a[f+1>c?c:f+1],d-f)},Bezier:function(a,b){for(var c=0,d=a.length-1,f=Math.pow,g=e.Interpolation.Utils.Bernstein,h=0;d>=h;h++)c+=f(1-b,d-h)*f(b,h)*a[h]*g(d,h);return c},CatmullRom:function(a,b){var c=a.length-1,d=c*b,f=Math.floor(d),g=e.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(f=Math.floor(d=c*(1+b))),g(a[(f-1+c)%c],a[f],a[(f+1)%c],a[(f+2)%c],d-f)):0>b?a[0]-(g(a[0],a[0],a[1],a[1],-d)-a[0]):b>1?a[c]-(g(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):g(a[f?f-1:0],a[f],a[f+1>c?c:f+1],a[f+2>c?c:f+2],d-f)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=e.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var d=b;d>1;d--)c*=d;return a[b]=c,c}}(),CatmullRom:function(a,b,c,d,e){var f=.5*(c-a),g=.5*(d-b),h=e*e,i=e*h;return(2*b-2*c+f+g)*i+(-3*b+3*c-2*f-g)*h+f*e+b}}},function(b){"function"==typeof a&&a.amd?a([],function(){return e}):"undefined"!=typeof c&&"object"==typeof d?c.exports=e:void 0!==b&&(b.TWEEN=e)}(this)}).call(this,b("_process"))},{_process:1}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.Datapoint=c.WebSocketDataset=c.Dataset=void 0;var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("papaparse"),j=d(i),k=a("object-assign"),l=d(k),m=c.Dataset=function(){function a(){g(this,a),this.datapoints={},this.embeddings=[]}return h(a,[{key:"add",value:function(a){var b;b=a instanceof n?a:new n(a),this.datapoints[b.id]=b,this.sendNotifications("add",b.id)}},{key:"remove",value:function(a){delete this.datapoints[a],this.sendNotifications("remove",a)}},{key:"update",value:function(a,b,c){var d=this.datapoints[a];if(d){var e=d.get(b);d.set(b,c),this.sendNotifications("update",a,b,c,e)}}},{key:"get",value:function(a){return this.datapoints[a]}},{key:"getIds",value:function(){return Object.keys(this.datapoints)}},{key:"register",value:function(a){this.embeddings.push(a)}},{key:"sendNotifications",value:function(a,b){var c={type:a,id:b};"update"==a&&(c.attr=arguments.length<=2?void 0:arguments[2],c.newVal=arguments.length<=3?void 0:arguments[3],c.oldVal=arguments.length<=4?void 0:arguments[4]),this.embeddings.forEach(function(a){return a.notify(c)})}}],[{key:"createFromCSV",value:function(b,c){j["default"].parse(b,{download:!0,header:!0,dynamicTyping:!0,complete:function(b){var d=new a;for(var e in b.data){var f=b.data[e];f._id=e,d.add(f)}c(d)}})}}]),a}(),n=(c.WebSocketDataset=function(a){function b(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(this,b),c=l["default"]({onmessage:function(a){return a},init:function(a){}},c);var d=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.options=c,d.socket=new WebSocket(a),d.socket.onopen=function(){return d.options.init(d.socket)},d.socket.onmessage=function(a){var b=this.options.onmessage(JSON.parse(a.data));this.add(b)}.bind(d),d}return f(b,a),b}(m),c.Datapoint=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_id";g(this,a),this.values=b,this.idAttribute=c}return h(a,[{key:"get",value:function(a){return this.values[a]}},{key:"set",value:function(a,b){this.values[a]=b}},{key:"id",get:function(){return this.values[this.idAttribute]}}]),a}())},{"object-assign":3,papaparse:4}],15:[function(a,b,c){"use strict";function d(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function e(){return navigator.getVRDisplays?h.VR:d()?h.MOBILE:h.DESKTOP}function f(a){if(navigator.getGamepads){var b=navigator.getGamepads(),c=!0,e=!1,f=void 0;try{for(var g,j=b[Symbol.iterator]();!(c=(g=j.next()).done);c=!0){var k=g.value;if(k&&k.pose){if(k.pose.hasPosition)return i.VR_6DOF;if(k.pose.hasOrientation)return i.VR_3DOF}}}catch(l){e=!0,f=l}finally{try{!c&&j["return"]&&j["return"]()}finally{if(e)throw f}}}return d()?a==h.VR?i.VR_GAZE:i.TOUCH:i.KB_MOUSE}function g(){var a=e(),b=f(a);return{displayMode:a,inputMode:b}}Object.defineProperty(c,"__esModule",{value:!0}),c.detectMode=g;var h=c.DISPLAY_TYPES={DESKTOP:"DESKTOP_DISPLAY",MOBILE:"MOBILE_DSIPLAY",VR:"VR_DISPLAY"},i=c.INPUT_TYPES={KB_MOUSE:"KB_MOUSE_INPUT",TOUCH:"TOUCH_INPUT",VR_GAZE:"VR_GAZE_INPUT",VR_3DOF:"VR_3DOF_INPUT",VR_6DOF:"VR_6DOF_INPUT"}},{}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0}),c.ConsoleEmbedding=c.PathEmbedding=c.ScatterEmbedding=c.PointsEmbedding=c.RandomEmbedding=c.MeshEmbedding=c.Embedding=void 0;var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a("object-assign"),k=d(j),l=a("tween.js"),m=d(l),n=c.Embedding=function(){function a(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};g(this,a),this.dataset=c,c&&c.register(this),this.obj3D=new THREE.Object3D,b.add(this.obj3D),this.initialized=!1,this.events=[],d=k["default"]({x:0,y:0,z:0},d),d=k["default"]({rx:0,ry:0,rz:0},d),d=k["default"]({sx:1,sy:1,sz:1},d),d=k["default"]({mapping:{}},d),this.options=d,this.obj3D.position.set(d.x,d.y,d.z),this.obj3D.rotation.set(d.rx,d.ry,d.rz),this.obj3D.scale.set(d.sx,d.sy,d.sz),this.mapping=this.options.mapping}return i(a,[{key:"_map",value:function(a,b){var c=this.mapping[b];return c?a.get(c):a.get(b)}},{key:"_mapAttr",value:function(a){var b=this.mapping[a];return b?b:a}},{key:"embed",value:function(){}},{key:"notify",value:function(a){this.events.push(a)}},{key:"getOpt",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=this.options[a];return"function"==typeof c?c(b):c}}]),a}(),o=c.MeshEmbedding=function(a){function b(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return g(this,b),e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,d))}return f(b,a),b}(n),p=(c.RandomEmbedding=function(a){function b(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return g(this,b),d=k["default"]({spread:1},d),e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,d))}return f(b,a),i(b,[{key:"embed",value:function(){if(!this.initialized){for(var a in this.dataset.datapoints){var b=this.dataset.datapoints[a];this._createMeshForDatapoint(b)}this.initialized=!0}}},{key:"_createMeshForDatapoint",value:function(a){var b=new THREE.Vector3(normal()*this.spread,normal()*this.spread,normal()*this.spread),c=new THREE.BoxGeometry(.1,.1,.1),d=new THREE.MeshBasicMaterial({color:new THREE.Color(Math.random(),Math.random(),Math.random())}),e=new THREE.Mesh(c,d);e.position.copy(b),this.obj3D.add(e)}},{key:"spread",get:function(){return this.getOpt("spread")}}]),b}(o),c.PointsEmbedding=function(a){function b(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};g(this,b),d=k["default"]({pointType:"ball",pointSize:.2,pointColor:16777215},d);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,d)),h=(new THREE.TextureLoader).load("https://rawgit.com/beaucronin/embedding/master/static/sprites/ball.png"),i={size:f.getOpt("pointSize"),sizeAttenuation:!0,map:h,color:f.getOpt("pointColor"),alphaTest:.5,transparent:!0};return f.points=new THREE.Points(new THREE.Geometry,new THREE.PointsMaterial(i)),f.points.geometry.vertices.push(new THREE.Vector3(0,0,0)),f.obj3D.add(f.points),f}return f(b,a),b}(n)),q=(c.ScatterEmbedding=function(a){function b(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};g(this,b),d=k["default"]({bufferSize:1e3,moveSpeed:2,autoScale:!1,autoScaleRange:10},d);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,d));f.dpMap={},f.freeVertices=[];for(var h=0;h<f.getOpt("bufferSize");h++)f.points.geometry.vertices.push(new THREE.Vector3(-1e6,-1e6,-1e6)),f.freeVertices.push(h);return f.getOpt("autoScale")?(f._initAutoScale(f.getOpt("autoScaleRange")),console.log(f.rescale)):f.getOpt("rescale")||(f.rescale=new q),f.tweens={},f}return f(b,a),i(b,[{key:"_initAutoScale",value:function(a){var b=this,c=this.dataset.getIds().map(function(a){return b.dataset.get(a)}),d=Math.min.apply(Math,c.map(function(a){return a.get(b._mapAttr("x"))})),e=Math.max.apply(Math,c.map(function(a){return a.get(b._mapAttr("x"))})),f=Math.min.apply(Math,c.map(function(a){return a.get(b._mapAttr("y"))})),g=Math.max.apply(Math,c.map(function(a){return a.get(b._mapAttr("y"))})),h=Math.min.apply(Math,c.map(function(a){return a.get(b._mapAttr("z"))})),i=Math.max.apply(Math,c.map(function(a){return a.get(b._mapAttr("z"))}));this.rescale=new q(-(e+d)/2,-(g+f)/2,-(i+h)/2,a/(e-d),a/(g-f),a/(i-h))}},{key:"embed",value:function(){if(this.initialized){if(this.events.length>0){for(var a in this.events){var b=this.events[a];"add"==b.type?this._placeDatapoint(b.id):"remove"==b.type?this._removeDatapoint(b.id):"update"==b.type&&this._updateDatapoint(b.id,b)}this.points.geometry.verticesNeedUpdate=!0}this.events=[]}else{for(var c in this.dataset.datapoints)this._placeDatapoint(c);this.points.geometry.verticesNeedUpdate=!0,this.initialized=!0}m["default"].update()}},{key:"_placeDatapoint",value:function(a){var b=this.freeVertices.pop();if(void 0!=b){var c=this.dataset.datapoints[a];if(!c)return;this.points.geometry.vertices[b].set(this.rescale.scaleX(this._map(c,"x")),this.rescale.scaleY(this._map(c,"y")),this.rescale.scaleZ(this._map(c,"z"))),this.dpMap[a]=b}else console.warn("Vertex buffer size exceeded")}},{key:"_removeDatapoint",value:function(a){var b=this.dpMap[a];void 0!=b&&(this.points.geometry.vertices[b].set(-1e6,-1e6,-1e6),delete this.dpMap[a],this.freeVertices.push(b))}},{key:"_updateDatapoint",value:function(a,b){var c=this,d=this.dpMap[a];if(void 0!=d){var e,f,g=function(){var b=c.dataset.datapoints[a];if(!b)return{v:void 0};var g=c.points.geometry.vertices[d],h={x:g.x,y:g.y,z:g.z},i={x:c.rescale.scaleX(c._map(b,"x")),y:c.rescale.scaleY(c._map(b,"y")),z:c.rescale.scaleZ(c._map(b,"z"))},j=new THREE.Vector3(h.x,h.y,h.z).sub(new THREE.Vector3(i.x,i.y,i.z)).length(),k=1e3*j/c.getOpt("moveSpeed",b);e=c.points.geometry,f=c,c.tweens[d]&&(c.tweens[d].stop(),delete c.tweens[d]);var l=new m["default"].Tween(h).to(i,k).onUpdate(function(){g.set(this.x,this.y,this.z),e.verticesNeedUpdate=!0}).onComplete(function(){return delete f.tweens[a]}).onStop(function(){return delete f.tweens[a]}).easing(m["default"].Easing.Exponential.InOut).start();c.tweens[d]=l}();if("object"===("undefined"==typeof g?"undefined":h(g)))return g.v}}}]),b}(p),c.PathEmbedding=function(a){function b(a,c,d,f){g(this,b),f=k["default"]({meshSizeX:.2,meshSizeY:.2,meshSizeZ:.2,description:"",removeAfter:!0,pathTime:1e4},f);var h=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,f));return h.waypoints=d.map(function(a){return new THREE.Vector3(a[0],a[1],a[2])}),h.dpMap={},h.tweens={},h}return f(b,a),i(b,[{key:"embed",value:function(){if(this.events.length>0)for(var a in this.events){var b=this.events[a];"add"==b.type?this._placeDatapoint(b.id):"remove"==b.type?this._removeDatapoint(b.id):"update"==b.type&&this._updateDatapoint(b.id,b)}this.events=[],m["default"].update()}},{key:"_placeDatapoint",value:function(a){var b=this.dataset.datapoints[a],c=new THREE.BoxGeometry(this.getOpt("meshSizeX",b),this.getOpt("meshSizeY",b),this.getOpt("meshSizeZ",b)),d=new THREE.MeshBasicMaterial({color:1401481,shading:THREE.FlatShading});d=new THREE.MeshStandardMaterial({color:16711935,emissive:468276,side:THREE.DoubleSide,shading:THREE.FlatShading});var e=new THREE.Mesh(c,d);e.userData.description=this.getOpt("description",b),this.dpMap[a]=e,this.obj3D.add(e),THREE.input.add(e);var f={x:this.waypoints[0].x,y:this.waypoints[0].y,z:this.waypoints[0].z},g={x:this.waypoints.slice(1).map(function(a){return a.x}),y:this.waypoints.slice(1).map(function(a){return a.y}),z:this.waypoints.slice(1).map(function(a){return a.z})},h=this.getOpt("pathTime"),i=this,j=new m["default"].Tween(f).to(g,h).interpolation(m["default"].Interpolation.CatmullRom).onUpdate(function(){var a=e.position.clone(),b=new THREE.Vector3(this.x,this.y,this.z),c=b.sub(a).normalize(),d=new THREE.Vector3(1,0,0);e.position.set(this.x,this.y,this.z),e.quaternion.setFromUnitVectors(d,c)}).onComplete(function(){delete i.tweens[a],i.getOpt("removeAfter")&&i.obj3D.remove(e)}).onStop(function(){return delete i.tweens[a]}).start();this.tweens[a]=j}},{key:"_removeDatapoint",value:function(a){}},{key:"_updateDatapoint",value:function(a,b){}},{key:"_createMeshForDatapoint",value:function(){}}]),b}(n),c.ConsoleEmbedding=function(a){function b(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};g(this,b),d=k["default"]({font:"Bold 24px Arial",fillStyle:"rgba(255,0,0,0.95)"},d);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c,d));return f.canvas=document.createElement("canvas"),f.canvas.width=256,f.canvas.height=128,f.context=f.canvas.getContext("2d"),f.context.font=f.getOpt("font"),f.context.fillStyle=f.getOpt("fillStyle"),f.mesh=void 0,f}return f(b,a),i(b,[{key:"setText",value:function(a){this.mesh&&this.obj3D.remove(this.mesh),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillText(a,0,25);var b=new THREE.Texture(this.canvas);b.needsUpdate=!0;var c=new THREE.MeshBasicMaterial({map:b,side:THREE.DoubleSide});c.transparent=!0,this.mesh=new THREE.Mesh(new THREE.PlaneGeometry(.1*this.canvas.width,.1*this.canvas.height),c),this.mesh.position.set(this.getOpt("x"),this.getOpt("y"),this.getOpt("z")),this.obj3D.add(this.mesh)}}]),b}(n),function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;g(this,a),"number"==typeof b&&(this.xo=b,this.yo=c,this.zo=d,this.xs=e,this.ys=f,this.zs=h)}return i(a,[{key:"scaleX",value:function(a){return this.xs*(a+this.xo)}},{key:"scaleY",value:function(a){return this.ys*(a+this.yo)}},{key:"scaleZ",value:function(a){return this.zs*(a+this.zo)}}]),a}())},{"object-assign":3,"tween.js":13}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){var a=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",
new THREE.Scene),b=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4);b.position.z=10;var c=new THREE.VRControls(b);c.standing=!0;var d=new THREE.WebGLRenderer;d.setSize(window.innerWidth,window.innerHeight),d.setPixelRatio(window.devicePixelRatio),document.body.appendChild(d.domElement);var e=new THREE.VREffect(d);e.setSize(window.innerWidth,window.innerHeight);var g=new WebVRManager(d,e),h=function(a){e.setSize(window.innerWidth,window.innerHeight),b.aspect=window.innerWidth/window.innerHeight,b.updateProjectionMatrix()};window.addEventListener("resize",h,!0),window.addEventListener("vrdisplaypresentchange",h,!0),THREE.input=new i["default"](b,d.domElement),THREE.input.setSize(d.getSize()),a.add(THREE.input.getMesh());var j;return navigator.getVRDisplays().then(function(a){a.length>0&&(j=a[0],j.requestAnimationFrame(f))}),{scene:a,camera:b,manager:g,effect:e,cameraControls:c,vrDisplay:j}}function f(a){a||(a=Date.now());Math.min(a-p,500);p=a;var b=!0,c=!1,d=void 0;try{for(var e,g=o[Symbol.iterator]();!(b=(e=g.next()).done);b=!0){var h=e.value;h.embed()}}catch(i){c=!0,d=i}finally{try{!b&&g["return"]&&g["return"]()}finally{if(c)throw d}}THREE.input.update(),cameraControls.update(),manager.render(scene,camera,a),vrDisplay.requestAnimationFrame(f)}function g(a){o.push(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.initScene=e,c.animate=f,c.register=g;var h=a("ray-input"),i=d(h),j=a("query-string"),k=d(j),l=a("./dataset.js"),m=a("./embedding.js"),n=a("./detection-utils.js"),o=[],p=0;b.exports={Dataset:l.Dataset,WebSocketDataset:l.WebSocketDataset,Embedding:m.Embedding,MeshEmbedding:m.MeshEmbedding,RandomEmbedding:m.RandomEmbedding,ScatterEmbedding:m.ScatterEmbedding,PathEmbedding:m.PathEmbedding,ConsoleEmbedding:m.ConsoleEmbedding,initScene:e,animate:f,queryString:k["default"],detectMode:n.detectMode,register:g}},{"./dataset.js":14,"./detection-utils.js":15,"./embedding.js":16,"query-string":5,"ray-input":9}]},{},[17])(17)});